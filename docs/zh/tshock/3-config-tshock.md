# 3.配置TShock
当你完成章节1和章节2后，恭喜你已经可以加入自己开的TShock服务器了，但是这还远远不够，默认配置下的TShock完全不能满足服主们的要求。


## JSON格式

JSON格式是TShock中最常见的配置文件格式，作用与MC中的yaml相当，但是比yaml更加清晰
```json
{
  "自动踢出Poooo": true,
  "坠落之星数量": 300,
  "角度": 3.14,
  "战败宣言": "哎呀，我没有史莱姆鞍啊!还是失误了...",
  "死亡掉落钱币": {
    "铂金": 591,
    "金": 60,
    "银": 15,
    "铜": 3,
  },
  "需要的物品": ["史莱姆鞍", "星星炮"]
}
```

### 键值对
顾名思义，键值对是键和值组成一对，即：
```json5
"键" : 值
```
有几点值得注意：
1. 键必须是英文双引号包括`"键"`(√)，中文双引号则会产生错误`“键”`(X)
2. 键具有唯一性，在同一个对象中(同一个`{}`)不可以出现一样的键
3. 值可以是对象和数组
4. 多个键值对用英文逗号`,`隔开

### bool值 (布尔值)
bool值只有`true`和`false`两个值
- true：一般表示启用或者指键的内容为真
- true：一般表示关闭或者指键的内容为假
```json5
"自动踢出Poooo": true // 启用自动踢出Poooo
或
"自动踢出Poooo": false // 关闭自动踢出Poooo
```
### 整数
整数可以是正整数或者负整数，但是具体范围请参考具体插件的配置教程
```json
"坠落之星数量": 300
```

### 小数
和整数类似但是有小数点
```json
"角度": 3.14
```
> [!CAUTION]
> 3.0 ≠ 3  
> 前者是小数，后者是整数，具体用那种参考插件配置

### 字符串
字符串和键一样，需要使用英文双引号包裹`"字符串"`
```json
"战败宣言": "哎呀，我没有史莱姆鞍啊!还是失误了..."
```

### 数组
数组在中括号`[...]`中书写，表示一组数据，每项数据用英文逗号`,`隔开
```json
"需要的物品": ["史莱姆鞍", "星星炮"],
"10以内的偶数": [0, 2, 4, 6, 8, 10],
"初始背包": [
      {
        "netID": -15,
        "prefix": 0,
        "stack": 1
      },
      {
        "netID": -13,
        "prefix": 0,
        "stack": 1
      },
      {
        "netID": -16,
        "prefix": 0,
        "stack": 1
      }
    ]
```

### 对象
对象在大括号`{...}`中书写，包含多个键值对。在TShock中一般整个配置文件就是一个对象
```json5
{ //配置文件对象，包含多个键值对
  "自动踢出Poooo": true,
  "坠落之星数量": 300,
  "角度": 3.14,
  "战败宣言": "哎呀，我没有史莱姆鞍啊!还是失误了...",
  "死亡掉落钱币": { // 钱币对象
    "铂金": 591,
    "金": 60,
    "银": 15,
    "铜": 3,
  },
  "需要的物品": ["史莱姆鞍", "星星炮"]
}
```

## 安装VS Code (可选)

### Windows

1. 直接在服务器上下载VS Code，然后安装一路下一步
  https://code.visualstudio.com
2. 安装中文语言包
   ![PixPin_2025-08-04_10-08-00](https://raw.githubusercontent.com/ACaiCat/cai-image/main/PixPin_2025-08-04_10-08-00.gif)
3. 尝试打开配置文件进行编辑 (下面是演示，请不要真的修改配置)
  ![PixPin_2025-08-04_11-15-29](https://raw.githubusercontent.com/ACaiCat/cai-image/main/PixPin_2025-08-04_11-15-29.gif)
### Linux

1. 直接将VS Code安装在自己的电脑即可，步骤同Windows 1、2 
2. 在Tabby的SFTP中找到配置文件，并且`右键`选择`本地编辑`，从VS Code中打开 (下面是演示，请不要真的修改配置)
   ![PixPin_2025-08-04_11-18-52](https://raw.githubusercontent.com/ACaiCat/cai-image/main/PixPin_2025-08-04_11-18-52.gif)
> [!IMPORTANT]
> 编辑完成后需要按`Ctrl+S`或者选择`文件-保存`进行保存，才会自动上传到服务器


### 查看错误
点击下栏的错误与警告即可查看当前JSON文件是否有语法错误，双击对应的错误即可跳转到相关行 (不一定准确)
![Pin_2025-08-04_11-22-44](https://raw.githubusercontent.com/ACaiCat/cai-image/main/PixPin_2025-08-04_11-22-44.gif)

> [!IMPORTANT]
> 只有错误数归零配置文件才能正确加载，否则会直接报错  
> ![20250804112758](https://raw.githubusercontent.com/ACaiCat/cai-image/main/20250804112758.png)  
> 从报错中我们可以看到`JSON`的字样，还能找到对应的报错行号`line 6`

## 关于配置文件

- TShock及TShock插件的配置文件基本上都是JSON
- 键一般是英文的，请查阅相关参考文档。即使键是中文的，也建议参考相关文档
- 一般来说使用命令`/reload`即可重启服务器，但是部分配置需要重启服务器
- 通常，删除配置文件并重启即可将配置文件恢复到默认状态
- 有的插件还会有隐藏选项，例如：`yaaiomni`，需要你手动加上隐藏的键值对才能进行配置
- 请根据相关文档配置，不要无中生有

## 配置SSC
`SSC`的全称是`Server Side Characters`(服务端角色)，也就是平时所说的**强制开荒**，启用SSC功能服务器可以最大程度操控玩家，且玩家的人物数据(背包，猪猪储钱罐，血量，永久增益等)将会交给服务器储存管理，也不会把服务器的数据覆盖到本地人物上。  


### 配置文件

SSC配置文件位于`tshock/sscconfig.json`，使用VS Code打开它
```json5
{
  "Settings": {
    "Enabled": false, // 启用SSC
    "ServerSideCharacterSave": 5, // 每隔几分钟保存一次角色数据 (不影响退出保存)
    "LogonDiscardThreshold": 250, // 加入服务器后一段时间阻止玩家丢弃物品以防夹带 (单位: 毫秒)
    "StartingHealth": 100, // 初始生命值
    "StartingMana": 20, // 初始魔力值
    "StartingInventory": [ // 初始背包物品 (数组，可以自己添加新物品)
      {
        "netID": -15, // 物品ID
        "prefix": 0, // 物品修饰语ID
        "stack": 1 // 物品数量
      },
      {
        "netID": -13,
        "prefix": 0,
        "stack": 1
      },
      {
        "netID": -16,
        "prefix": 0,
        "stack": 1
      }
    ],
    "WarnPlayersAboutBypassPermission": true // 当玩家有权限绕过SSC时发出警告
  }
}
```

### 基本配置

#### `Enabled`
如果你要启用SSC，或者说你想开一个强制开荒服，就将选项设为`true`。如果你想让服务器玩家正常携带自己角色物品，打造一个像茑萝PVP的服务器，就将选项设为`false`

> [!CAUTION]
> 关闭SSC会导致许多插件失去作用


#### `StartingHealth`和`StartingMana`
分别是初始生命值和初始魔力值，自行按需设置

#### `StartingInventory`
玩家初始物品，默认情况下就是三件套，是一个物品对象数组  
物品对象大概长这样:  
```
{
  "netID": -16, // 物品ID
  "prefix": 0,  // 物品堆叠
  "stack": 1    // 物品数量
}
```
物品数组就是用英文逗号`,`把每个隔开写进`[]`中
```
[ // 数组起始位置
    {
      "netID": -15, 
      "prefix": 0,
      "stack": 1
    }, // 逗号隔开
    {
      "netID": -13,
      "prefix": 0,
      "stack": 1
    }, // 逗号隔开
    {
      "netID": -16,
      "prefix": 0,
      "stack": 1
    }
] // 数组终止位置
```
> [!NOTE]
> 物品ID和修饰语ID可以使用wiki、CaiBotLite、帕秋莉、ID查询器等工具查询  
> CaiBotLite、帕秋莉、云黑BOT请带回自己群里领养使用，请不要在TShock群使用

#### 其他配置
修改配置有两个原则：
- 看不懂的不要动
- 用不到的不要动

如有需要且理解含义，按需修改即可

> [!IMPORTANT]
> 配置完SSC需要重启服务器才会生效哦~
